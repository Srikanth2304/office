SELECT 
  CASE 
    WHEN EXISTS (
      SELECT 1 FROM RELCONT WHERE CONTACTTYPE = 'EMR'
    ) THEN (
      SELECT CONTACT FROM RELCONT WHERE CONTACTTYPE = 'EMR' FETCH FIRST 1 ROW ONLY
    )
    WHEN EXISTS (
      SELECT 1 FROM RELCONT WHERE CONTACTTYPE = 'EMO'
    ) THEN (
      SELECT CONTACT FROM RELCONT WHERE CONTACTTYPE = 'EMO' FETCH FIRST 1 ROW ONLY
    )
    ELSE (
      SELECT CONTACT FROM RELCONT WHERE PRIMARYCONTACT = 'Y' FETCH FIRST 1 ROW ONLY
    )
  END AS DefaultContact
FROM dual;




SELECT CONTACT
FROM RELCONT
WHERE CONTACTTYPE = 'EMR'
   OR CONTACTTYPE = 'EMO'
   OR PRIMARYCONTACT = 'Y'
ORDER BY 
  CASE 
    WHEN CONTACTTYPE = 'EMR' THEN 1
    WHEN CONTACTTYPE = 'EMO' THEN 2
    WHEN PRIMARYCONTACT = 'Y' THEN 3
    ELSE 4
  END
FETCH FIRST 1 ROW ONLY;  -- Use LIMIT 1 if using MySQL/PostgreSQL





SELECT contact 
FROM RELCONT
WHERE contacttypecode = 'EMR'
   OR contacttypecode = 'EMO'
   OR primarycontact = 'Y'
ORDER BY 
  CASE 
    WHEN contacttypecode = 'EMR' THEN 1
    WHEN contacttypecode = 'EMO' THEN 2
    WHEN primarycontact = 'Y' THEN 3
    ELSE 4
  END
FETCH FIRST 1 ROW ONLY;



SELECT contact
FROM RELCONT
WHERE contacttypecode = 'EMR'
   OR contacttypecode = 'EMO'
   OR primarycontact = 'Y'
ORDER BY 
  CASE 
    WHEN contacttypecode = 'EMR' THEN 1
    WHEN contacttypecode = 'EMO' THEN 2
    WHEN primarycontact = 'Y' THEN 3
    ELSE 4
  END
LIMIT 1;




select rel.relationshipno ,rel.salutationcode ,rel.fullname,reladdr.flatno ,reladdr.bldgname ,reladdr.nrlandmrk, 

reladdr.street ,reladdr.address1 ,reladdr.address2 ,reladdr.postbox ,reladdr.postalcode ,reladdr.state,city.name, 

cntry.name ,relcont.contact,MLITSUB.currencycode ,MLITSUB.accountno ,MLITSUB.limitamt ,MLITSUB.odstartdate ,

MLITSUB.checkerdate ,MLITSUB.statusflag from rel inner join reladdr on 

rel.relationshipno = reladdr.relationshipno inner join city on reladdr.citycode = city.citycode inner join cntry 

on reladdr.countrycode = cntry.countrycode inner join relcont on rel.relationshipno = relcont.relationshipno 

inner join mastrel on rel.relationshipno = mastrel.relationshipno inner join account on 

mastrel.masterno = account.masterno inner join MLITSUB on account.accountno = MLITSUB.accountno where 

relcont.contacttypecode ='EMR' or relcont.contacttypecode ='EMO'or relcont.primarycontact ='Y' and 

MLITSUB.statusflag='18' and mastrel.primaryflag ='Y' limit 50
 
