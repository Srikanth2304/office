SELECT 
  CASE 
    WHEN EXISTS (
      SELECT 1 FROM RELCONT WHERE CONTACTTYPE = 'EMR'
    ) THEN (
      SELECT CONTACT FROM RELCONT WHERE CONTACTTYPE = 'EMR' FETCH FIRST 1 ROW ONLY
    )
    WHEN EXISTS (
      SELECT 1 FROM RELCONT WHERE CONTACTTYPE = 'EMO'
    ) THEN (
      SELECT CONTACT FROM RELCONT WHERE CONTACTTYPE = 'EMO' FETCH FIRST 1 ROW ONLY
    )
    ELSE (
      SELECT CONTACT FROM RELCONT WHERE PRIMARYCONTACT = 'Y' FETCH FIRST 1 ROW ONLY
    )
  END AS DefaultContact
FROM dual;




SELECT CONTACT
FROM RELCONT
WHERE CONTACTTYPE = 'EMR'
   OR CONTACTTYPE = 'EMO'
   OR PRIMARYCONTACT = 'Y'
ORDER BY 
  CASE 
    WHEN CONTACTTYPE = 'EMR' THEN 1
    WHEN CONTACTTYPE = 'EMO' THEN 2
    WHEN PRIMARYCONTACT = 'Y' THEN 3
    ELSE 4
  END
FETCH FIRST 1 ROW ONLY;  -- Use LIMIT 1 if using MySQL/PostgreSQL





SELECT contact 
FROM RELCONT
WHERE contacttypecode = 'EMR'
   OR contacttypecode = 'EMO'
   OR primarycontact = 'Y'
ORDER BY 
  CASE 
    WHEN contacttypecode = 'EMR' THEN 1
    WHEN contacttypecode = 'EMO' THEN 2
    WHEN primarycontact = 'Y' THEN 3
    ELSE 4
  END
FETCH FIRST 1 ROW ONLY;
